import{r as a,j as e,m as h,C as j,c as N,e as W,T as B,a as G,b as O,S as U,d as Q,B as S,g as p}from"./index.Cl3CnLBx.js";const c=[{prophet:"Prophet Nuh (AS)",emoji:"ðŸš¢",storyParts:["Prophet Nuh called people to worship Allah for 950 years","People didn't listen and made fun of him","Allah told him to build a big ark (ship)","The great flood came and the ark saved the believers"],moral:"Always be patient and trust in Allah, even if it takes a long time.",quiz:{question:"How long did Prophet Nuh call people to Islam?",options:["100 years","500 years","950 years","1000 years"],correct:2},points:2},{prophet:"Prophet Ibrahim (AS)",emoji:"ðŸ”¥",storyParts:["Prophet Ibrahim broke the idols to show people they had no power","The king ordered him to be thrown into a huge fire","Allah commanded the fire: 'Be cool and safe for Ibrahim!'","The fire didn't hurt him at all - it was a miracle!"],moral:"When you trust in Allah, He will protect you from all harm.",quiz:{question:"What happened to Prophet Ibrahim in the fire?",options:["He got burned","He escaped","Allah made the fire cool and safe","People saved him"],correct:2},points:2},{prophet:"Prophet Yusuf (AS)",emoji:"ðŸ‘‘",storyParts:["Prophet Yusuf's brothers were jealous of him","They threw him in a well, but he was rescued","He was sold as a slave but stayed patient and good","Years later, he became the minister of Egypt and forgave his brothers"],moral:"Patience, forgiveness, and good character lead to success.",quiz:{question:"What did Prophet Yusuf do when he met his brothers again?",options:["Punished them","Forgave them","Ignored them","Sent them away"],correct:1},points:2},{prophet:"Prophet Musa (AS)",emoji:"âš¡",storyParts:["Prophet Musa was saved as a baby from Pharaoh's cruel orders","Allah chose him to be a Prophet and speak to Pharaoh","Pharaoh refused to free the slaves","Allah parted the Red Sea for Musa and the believers to escape"],moral:"Allah helps those who stand up for what is right.",quiz:{question:"What miracle did Allah show through Prophet Musa?",options:["Made rain","Parted the sea","Moved mountains","Created trees"],correct:1},points:2}],_=(m,s)=>{const u=m[s],o=[...m].sort(()=>Math.random()-.5),x=o.indexOf(u);return{shuffled:o,newCorrectIndex:x}};function R({onComplete:m}){const[s,u]=a.useState(0),[o,x]=a.useState(0),[f,g]=a.useState(!1),[i,y]=a.useState(null),[n,v]=a.useState(0),[P,A]=a.useState(!1),[b,C]=a.useState(null),[z,k]=a.useState([]),[w,q]=a.useState(0);a.useEffect(()=>{(async()=>{try{if(await p.auth.isAuthenticated()){const d=await p.auth.me();C(d)}}catch{console.log("User not authenticated")}})()},[]),a.useEffect(()=>{if(f){const t=c[s],{shuffled:r,newCorrectIndex:d}=_(t.quiz.options,t.quiz.correct);k(r),q(d)}},[f,s]);const T=()=>{const t=c[s];o<t.storyParts.length-1?x(o+1):g(!0)},M=t=>{y(t);const r=c[s];t===w&&v(n+r.points),setTimeout(()=>{s<c.length-1?(u(s+1),x(0),g(!1),y(null)):I()},2e3)},I=async()=>{if(A(!0),b)try{await p.entities.GameScore.create({user_id:b.id,game_type:"prophet_stories",score:n,completed:!0}),await p.auth.updateMe({points:(b.points||0)+n})}catch(t){console.error("Error saving game score:",t)}m(n)};if(P)return e.jsx(h.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"text-center py-12",children:e.jsx(j,{className:"max-w-md mx-auto border-2 border-amber-400 shadow-2xl",children:e.jsxs(N,{className:"pt-12 pb-8",children:[e.jsx(h.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:200},children:e.jsx(W,{className:"w-24 h-24 mx-auto mb-6 text-amber-500"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Amazing! ðŸŒŸ"}),e.jsxs("p",{className:"text-xl text-gray-600 mb-6",children:["You earned ",e.jsxs("span",{className:"font-bold text-amber-600",children:[n," points!"]})]}),e.jsx("div",{className:"bg-amber-50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-gray-700",children:"You've learned wonderful stories of the Prophets. These stories teach us important lessons!"})})]})})});const l=c[s];return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs(h.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-gradient-to-r from-purple-600 to-indigo-700 text-white rounded-lg p-4 mb-6 text-center shadow-md flex flex-col sm:flex-row items-center justify-center gap-3 w-full max-w-2xl",children:[e.jsx(B,{className:"w-6 h-6 text-yellow-300 flex-shrink-0"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:gap-2",children:[e.jsx("p",{className:"font-semibold text-lg",children:"Monthly Prize Competition!"}),e.jsx("p",{className:"text-sm text-indigo-100",children:"(Top scorer wins a prize!)"})]})]}),e.jsxs(j,{className:"max-w-2xl mx-auto shadow-lg",children:[e.jsxs(G,{className:"bg-gradient-to-r from-amber-500 to-orange-500 text-white",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(O,{className:"text-2xl flex items-center gap-2",children:[e.jsx("span",{className:"text-3xl",children:l.emoji}),"Prophet Stories"]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white/20 px-4 py-2 rounded-full",children:[e.jsx(U,{className:"w-5 h-5 text-amber-300"}),e.jsxs("span",{className:"font-bold",children:[n," pts"]})]})]}),e.jsxs("p",{className:"text-sm mt-2",children:["Story ",s+1," of ",c.length]})]}),e.jsx(N,{className:"p-4 md:p-8",children:f?e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[e.jsxs("div",{className:"mb-4 md:mb-6 px-2",children:[e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 md:p-6 mb-4 md:mb-6",children:[e.jsx("h4",{className:"font-bold text-blue-900 mb-2 text-sm md:text-base",children:"Moral of the Story:"}),e.jsx("p",{className:"text-gray-700 text-sm md:text-base",children:l.moral})]}),e.jsx("h4",{className:"text-lg md:text-xl font-bold text-gray-900 mb-3 md:mb-4 leading-snug",children:l.quiz.question})]}),e.jsx("div",{className:"grid gap-2 md:gap-3",children:z.map((t,r)=>{const d=r===w,E=r===i,H=i!==null&&d,Y=i!==null&&E&&!d;return e.jsx(S,{onClick:()=>i===null&&M(r),disabled:i!==null,className:`h-auto py-3 md:py-4 px-3 md:px-4 text-sm md:text-lg justify-start transition-all duration-300 ${H?"bg-green-500 hover:bg-green-600 text-white":Y?"bg-red-500 hover:bg-red-600 text-white":"bg-white hover:bg-amber-50 text-gray-900 border-2"}`,variant:i!==null?"default":"outline",children:e.jsx("span",{className:"flex-1 text-left leading-snug break-words",children:t})},r)})})]}):e.jsxs(h.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},children:[e.jsxs("div",{className:"text-center mb-4 md:mb-6",children:[e.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-900 mb-2",children:l.prophet}),e.jsxs(Q,{className:"bg-amber-100 text-amber-800 text-xs md:text-sm",children:["Part ",o+1," of ",l.storyParts.length]})]}),e.jsx("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl p-6 md:p-8 mb-4 md:mb-6 min-h-[180px] md:min-h-[200px] flex items-center justify-center",children:e.jsx("p",{className:"text-base md:text-xl text-gray-800 leading-relaxed text-center",children:l.storyParts[o]})}),e.jsx("div",{className:"text-center",children:e.jsx(S,{onClick:T,size:"lg",className:"bg-gradient-to-r from-amber-500 to-orange-500 w-full md:w-auto",children:o<l.storyParts.length-1?"Continue Story":"Take Quiz"})})]},`${s}-${o}`)})]})]})}export{R as default};
