import{q as F,r as l,g as $,j as e,C as j,a as C,b as z,c as f,m as k,B as g,T as O,R as E,d as U,l as W,f as Q}from"./index.BaQrC8Rc.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],X=F("Puzzle",V),Y=[{id:"aqsa",name:"Al-Masjid al-Aqsa",description:"The Noble Sanctuary in Jerusalem",emoji:"ðŸ•Œ",imageUrl:"https://images.unsplash.com/photo-1542816417-0983c9c9ad53?w=800&q=80"},{id:"haram",name:"Al-Masjid al-Haram (The Kaaba in Makkah)",description:"The Sacred Mosque with the Holy Kaaba in Makkah",emoji:"ðŸ•‹",imageUrl:"https://images.unsplash.com/photo-1591604466107-ec97de577aff?w=800&q=80"},{id:"nabawi",name:"Al-Masjid an-Nabawi (Madinah)",description:"The Prophet's Mosque with the Green Dome in Madinah",emoji:"ðŸŒ™",imageUrl:"https://images.unsplash.com/photo-1591135480936-0b5e90c2f7e6?w=800&q=80"}],m={easy:{pieces:9,gridSize:3,points:50},medium:{pieces:16,gridSize:4,points:100},hard:{pieces:25,gridSize:5,points:200}};function Z({onComplete:M}){const[r,p]=l.useState(null),[d,T]=l.useState(null),[x,b]=l.useState([]),[h,w]=l.useState([]),[o,N]=l.useState(null),[y,v]=l.useState(0),[A,D]=l.useState(null),[G,S]=l.useState(!1),[R,B]=l.useState(null);l.useEffect(()=>{H()},[]);const H=async()=>{try{if(await $.auth.isAuthenticated()){const t=await $.auth.me();B(t)}}catch{console.log("User not authenticated")}},L=(s,t)=>{p(s),T(t),D(Date.now());const{gridSize:a}=m[t],c=[];for(let i=0;i<a;i++)for(let n=0;n<a;n++)c.push({id:`${i}-${n}`,correctRow:i,correctCol:n,currentRow:i,currentCol:n});const q=c.sort(()=>Math.random()-.5);q.forEach((i,n)=>{const I=Math.floor(n/a),K=n%a;i.currentRow=I,i.currentCol=K}),b(q),w([]),v(0),S(!1)},_=s=>{if(!h.includes(s.id))if(!o)N(s);else{const t={row:o.currentRow,col:o.currentCol};o.currentRow=s.currentRow,o.currentCol=s.currentCol,s.currentRow=t.row,s.currentCol=t.col,b([...x]),N(null),v(y+1);const a=[...h];x.forEach(c=>{c.correctRow===c.currentRow&&c.correctCol===c.currentCol&&!h.includes(c.id)&&a.push(c.id)}),w(a),a.length===x.length&&J()}},J=async()=>{S(!0);const s=m[d].points;if(R)try{await W(R,"sacred_sites_jigsaw",{fallbackScore:s})}catch(t){console.error("Error saving score:",t)}},P=()=>{p(null),T(null),b([]),w([]),N(null),v(0),S(!1)};if(!r)return e.jsxs(j,{className:"max-w-3xl mx-auto shadow-xl",children:[e.jsxs(C,{className:"bg-gradient-to-r from-emerald-600 to-teal-600 text-white",children:[e.jsxs(z,{className:"text-2xl flex items-center gap-2 justify-center",children:[e.jsx(X,{className:"w-6 h-6"}),"Sacred Sites Jigsaw"]}),e.jsx("p",{className:"text-center text-emerald-100 mt-2",children:"Choose a holy mosque to assemble"})]}),e.jsx(f,{className:"p-6",children:e.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:Y.map(s=>e.jsxs(k.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>p(s),className:"p-4 rounded-xl bg-gradient-to-br from-emerald-50 to-teal-50 border-2 border-emerald-200 hover:border-emerald-400 transition-all",children:[e.jsx("div",{className:"text-5xl mb-3",children:s.emoji}),e.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description})]},s.id))})})]});if(!d)return e.jsxs(j,{className:"max-w-2xl mx-auto shadow-xl",children:[e.jsx(C,{className:"bg-gradient-to-r from-emerald-600 to-teal-600 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(z,{className:"text-2xl flex items-center gap-2",children:[e.jsx("span",{className:"text-3xl",children:r.emoji}),r.name]}),e.jsx(g,{onClick:()=>p(null),variant:"ghost",size:"sm",className:"text-white hover:bg-white/20",children:"Back"})]})}),e.jsxs(f,{className:"p-8",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-6",children:"Select Difficulty"}),e.jsx("div",{className:"grid gap-4",children:Object.entries(m).map(([s,t])=>e.jsx(g,{onClick:()=>L(r,s),className:"h-auto py-6 bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600",size:"lg",children:e.jsxs("div",{className:"text-left w-full",children:[e.jsx("div",{className:"text-2xl font-bold capitalize mb-2",children:s}),e.jsxs("div",{className:"text-sm opacity-90",children:[t.pieces," pieces â€¢ ",t.points," points"]})]})},s))})]})]});if(G){const s=Math.floor((Date.now()-A)/1e3),t=m[d].points;return e.jsx(k.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"text-center py-12",children:e.jsx(j,{className:"max-w-md mx-auto border-2 border-green-400 shadow-2xl",children:e.jsxs(f,{className:"pt-12 pb-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:r.emoji}),e.jsx(O,{className:"w-24 h-24 mx-auto mb-6 text-green-500"}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Puzzle Complete! ðŸŽ‰"}),e.jsx("p",{className:"text-xl text-gray-600 mb-6",children:r.name}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsxs("p",{className:"text-lg",children:[e.jsx("strong",{children:"Time:"})," ",s,"s"]}),e.jsxs("p",{className:"text-lg",children:[e.jsx("strong",{children:"Moves:"})," ",y]}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[t," Points"]})]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsxs(g,{onClick:P,className:"bg-gradient-to-r from-green-500 to-teal-500",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Play Again"]}),M&&e.jsx(g,{onClick:()=>M(t),variant:"outline",children:"Back to Games"})]})]})})})}const{gridSize:u}=m[d];return e.jsxs(j,{className:"max-w-4xl mx-auto shadow-xl",children:[e.jsxs(C,{className:"bg-gradient-to-r from-emerald-600 to-teal-600 text-white",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(z,{className:"text-xl flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:r.emoji}),r.name]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(U,{className:"bg-white/30 backdrop-blur-sm text-white px-3 py-1",children:["Moves: ",y]}),e.jsxs(U,{className:"bg-white/30 backdrop-blur-sm text-white px-3 py-1",children:[h.length,"/",x.length]})]})]}),e.jsxs("p",{className:"text-emerald-100 text-sm mt-2 capitalize",children:[d," â€¢ ",m[d].pieces," pieces"]})]}),e.jsxs(f,{className:"p-6",children:[e.jsx("div",{className:"grid gap-1 mx-auto",style:{gridTemplateColumns:`repeat(${u}, 1fr)`,maxWidth:`${u*100}px`},children:x.map(s=>{const t=h.includes(s.id),a=(o==null?void 0:o.id)===s.id;return e.jsx(k.button,{onClick:()=>_(s),disabled:t,whileHover:{scale:t?1:1.05},whileTap:{scale:.95},className:`aspect-square rounded-lg transition-all ${t?"bg-green-500 border-2 border-green-600 cursor-default":a?"bg-blue-500 border-4 border-blue-600":"bg-gradient-to-br from-emerald-200 to-teal-200 border-2 border-emerald-300 hover:border-emerald-400"}`,style:{backgroundImage:t?`url(${r.imageUrl})`:"none",backgroundPosition:`${s.correctCol/(u-1)*100}% ${s.correctRow/(u-1)*100}%`,backgroundSize:`${u*100}%`},children:!t&&e.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs font-bold text-gray-700",children:s.id})},s.id)})}),e.jsx("div",{className:"flex justify-center gap-3 mt-6",children:e.jsxs(g,{onClick:P,variant:"outline",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Restart"]})})]})]})}Z.propTypes={onComplete:Q.func};export{Z as default};
