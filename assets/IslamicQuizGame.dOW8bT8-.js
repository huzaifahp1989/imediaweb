import{r as n,g as c,j as e,C as v,a as U,b as E,h as ie,c as N,m as j,T as re,e as ne,B as M,S as le,d as he,P as ce,A as de,i as ue,k as me,l as pe,f as z}from"./index.CTmbMkGJ.js";const ge=f=>{switch(f){case"Challenges":return"/challenges";default:return`/${f.toLowerCase()}`}},k={easy:[{id:"easy_1",category:"Quran",question:"What is the first Surah in the Quran?",options:["Al-Baqarah","Al-Fatiha","An-Nas","Al-Ikhlas"],correct:1,explanation:"Al-Fatiha is the opening chapter of the Quran."},{id:"easy_2",category:"Quran",question:"How many Surahs are in the Quran?",options:["100","114","120","99"],correct:1,explanation:"The Quran has 114 chapters (Surahs)."},{id:"easy_3",category:"Prophets",question:"Who was the last Prophet sent by Allah?",options:["Prophet Musa","Prophet Isa","Prophet Muhammad ï·º","Prophet Ibrahim"],correct:2,explanation:"Prophet Muhammad ï·º is the final messenger."},{id:"easy_4",category:"Fiqh",question:"How many times a day do Muslims pray?",options:["3","4","5","6"],correct:2,explanation:"Muslims pray five times daily."},{id:"easy_5",category:"Fiqh",question:"What must you do before praying?",options:["Sleep","Eat","Wudu","Run"],correct:2,explanation:"Wudu (ablution) is required before prayer."},{id:"easy_6",category:"Fiqh",question:"In which month do Muslims fast?",options:["Shawwal","Ramadan","Dhul Hijjah","Rajab"],correct:1,explanation:"Muslims fast during Ramadan."},{id:"easy_7",category:"Akhlaq",question:"What should you say before eating?",options:["Alhamdulillah","Bismillah","Masha'Allah","Subhanallah"],correct:1,explanation:"We say 'Bismillah' before eating."},{id:"easy_8",category:"Akhlaq",question:"What is the Islamic greeting?",options:["Hello","As-salamu alaikum","Good morning","Hi"],correct:1,explanation:"Muslims greet with 'As-salamu alaikum'."},{id:"easy_9",category:"History",question:"Where is the Kaaba located?",options:["Madinah","Jerusalem","Makkah","Egypt"],correct:2,explanation:"The Kaaba is in Makkah, Saudi Arabia."},{id:"easy_10",category:"Arabic",question:"What does 'Alhamdulillah' mean?",options:["God is Great","All praise is for Allah","Peace be upon you","In the name of Allah"],correct:1,explanation:"Alhamdulillah means 'All praise is for Allah'."},{id:"easy_11",category:"Prophets",question:"Which prophet was swallowed by a whale?",options:["Prophet Musa","Prophet Yunus","Prophet Nuh","Prophet Yusuf"],correct:1,explanation:"Prophet Yunus (Jonah) was swallowed by a whale and prayed inside it."},{id:"easy_12",category:"Quran",question:"Which Surah is known as the 'Heart of the Quran'?",options:["Al-Fatiha","Yasin","Al-Ikhlas","Al-Mulk"],correct:1,explanation:"Surah Yasin is called the heart of the Quran."},{id:"easy_13",category:"Beliefs",question:"How many angels are mentioned by name in the Quran?",options:["2","4","6","10"],correct:0,explanation:"Two angels are mentioned by name: Jibreel and Mikail."},{id:"easy_14",category:"History",question:"What was the first masjid built in Islam?",options:["Al-Aqsa","Al-Haram","Quba","Nabawi"],correct:2,explanation:"Masjid Quba was the first masjid in Islam."},{id:"easy_15",category:"Akhlaq",question:"What should you say after sneezing?",options:["Masha'Allah","Alhamdulillah","Subhanallah","Astaghfirullah"],correct:1,explanation:"We say 'Alhamdulillah' after sneezing to thank Allah."}],medium:[{id:"med_1",category:"Quran",question:"What is the longest Surah in the Quran?",options:["Al-Fatiha","Al-Baqarah","Al-Imran","An-Nisa"],correct:1,explanation:"Surah Al-Baqarah has 286 verses."},{id:"med_2",category:"Quran",question:"In which Surah is the story of Prophet Yusuf mentioned?",options:["Surah Yusuf","Surah Maryam","Surah Ibrahim","Surah Musa"],correct:0,explanation:"Surah Yusuf tells the beautiful story of Prophet Yusuf."},{id:"med_3",category:"Seerah",question:"What was the night journey of the Prophet ï·º called?",options:["Hijrah","Isra and Mi'raj","Umrah","Hajj"],correct:1,explanation:"Isra and Mi'raj was the miraculous night journey."},{id:"med_4",category:"Seerah",question:"Who was the first wife of Prophet Muhammad ï·º?",options:["Aisha","Khadijah","Hafsa","Fatimah"],correct:1,explanation:"Khadijah (RA) was the Prophet's first wife."},{id:"med_5",category:"Fiqh",question:"What is Zakat?",options:["Prayer","Charity","Fasting","Pilgrimage"],correct:1,explanation:"Zakat is obligatory charity."},{id:"med_6",category:"Fiqh",question:"How many Rakats are in Fajr prayer?",options:["2","3","4","5"],correct:0,explanation:"Fajr prayer has 2 Rakats."},{id:"med_7",category:"History",question:"Who was the first Caliph after Prophet Muhammad ï·º?",options:["Umar","Uthman","Ali","Abu Bakr"],correct:3,explanation:"Abu Bakr As-Siddiq (RA) was the first Caliph."},{id:"med_8",category:"Hadith",question:"The Prophet ï·º said: 'The best of you are those who are best to their...'",options:["Friends","Families","Neighbors","Animals"],correct:1,explanation:"The Prophet ï·º emphasized treating family well."},{id:"med_9",category:"Islamic Calendar",question:"Which is the 9th month of the Islamic calendar?",options:["Shawwal","Ramadan","Dhul Hijjah","Muharram"],correct:1,explanation:"Ramadan is the 9th month."},{id:"med_10",category:"Akhlaq",question:"What did the Prophet ï·º say is the heaviest thing on the scale of deeds?",options:["Prayer","Charity","Good character","Fasting"],correct:2,explanation:"Good character is the heaviest on the scale."},{id:"med_11",category:"Prophets",question:"Which prophet was given the Torah?",options:["Prophet Ibrahim","Prophet Musa","Prophet Isa","Prophet Dawud"],correct:1,explanation:"Prophet Musa (Moses) was given the Torah."},{id:"med_12",category:"Beliefs",question:"What are the pillars of Iman (faith)?",options:["5 pillars","6 pillars","7 pillars","4 pillars"],correct:1,explanation:"There are 6 pillars of Iman: belief in Allah, angels, books, prophets, Day of Judgment, and Qadr."},{id:"med_13",category:"Quran",question:"Which Surah was revealed entirely in one night?",options:["Al-Ikhlas","Al-Kawthar","Al-Fatiha","Al-Asr"],correct:0,explanation:"Surah Al-Ikhlas was revealed in one night."},{id:"med_14",category:"History",question:"In which city was Prophet Muhammad ï·º born?",options:["Madinah","Makkah","Taif","Jerusalem"],correct:1,explanation:"Prophet Muhammad ï·º was born in Makkah."},{id:"med_15",category:"Fiqh",question:"What is the difference between Fard and Sunnah?",options:["Fard is obligatory, Sunnah is recommended","They are the same","Sunnah is obligatory, Fard is recommended","Both are optional"],correct:0,explanation:"Fard actions are obligatory, while Sunnah actions are highly recommended."}],hard:[{id:"hard_1",category:"Quran",question:"How many prophets are mentioned by name in the Quran?",options:["20","25","30","40"],correct:1,explanation:"The Quran mentions 25 prophets by name."},{id:"hard_2",category:"Quran",question:"What is the shortest Surah in the Quran?",options:["Al-Ikhlas","Al-Kawthar","An-Nasr","Al-Asr"],correct:1,explanation:"Surah Al-Kawthar has only 3 verses."},{id:"hard_3",category:"Seerah",question:"What was the name of the cave where the Quran was first revealed?",options:["Cave of Thawr","Cave of Hira","Cave of Uhud","Cave of Badr"],correct:1,explanation:"The first revelation came in the Cave of Hira."},{id:"hard_4",category:"History",question:"How many Muslims fought in the Battle of Badr?",options:["100","313","500","1000"],correct:1,explanation:"Only 313 Muslims fought in the Battle of Badr."},{id:"hard_5",category:"Fiqh",question:"What is the meaning of 'Tawhid'?",options:["Prayer","Oneness of Allah","Charity","Fasting"],correct:1,explanation:"Tawhid is the oneness of Allah."},{id:"hard_6",category:"Hadith",question:"According to hadith, what are the three things that continue after death?",options:["Wealth, family, house","Charity, knowledge, righteous children","Prayer, fasting, Hajj","Gold, silver, land"],correct:1,explanation:"Charity, beneficial knowledge, and righteous children continue after death."},{id:"hard_7",category:"Beliefs",question:"Which angel blows the trumpet on the Day of Judgment?",options:["Jibreel","Mikail","Israfil","Azrael"],correct:2,explanation:"Angel Israfil will blow the trumpet."},{id:"hard_8",category:"History",question:"Who was known as 'Sayfu-llah' (Sword of Allah)?",options:["Abu Bakr","Umar","Khalid ibn Walid","Ali"],correct:2,explanation:"Khalid ibn Walid (RA) was called Sword of Allah."},{id:"hard_9",category:"Fiqh",question:"Worship on Laylatul Qadr is better than how many months?",options:["100","500","1000","10000"],correct:2,explanation:"Laylatul Qadr is better than a thousand months."},{id:"hard_10",category:"History",question:"What was the first masjid built in Islam?",options:["Masjid al-Haram","Masjid an-Nabawi","Masjid Quba","Masjid al-Aqsa"],correct:2,explanation:"Masjid Quba was the first masjid in Islam."},{id:"hard_11",category:"Quran",question:"Which Surah does not begin with Bismillah?",options:["Surah Al-Fatiha","Surah At-Tawbah","Surah Al-Ikhlas","Surah An-Nas"],correct:1,explanation:"Surah At-Tawbah (Chapter 9) is the only Surah that doesn't begin with Bismillah."},{id:"hard_12",category:"Prophets",question:"Which prophet could speak to animals and understand their language?",options:["Prophet Dawud","Prophet Sulaiman","Prophet Musa","Prophet Isa"],correct:1,explanation:"Prophet Sulaiman (Solomon) was given the ability to understand and speak to animals."},{id:"hard_13",category:"History",question:"How many years did Prophet Muhammad ï·º receive revelation?",options:["10 years","15 years","23 years","30 years"],correct:2,explanation:"The Prophet ï·º received revelation for 23 years (13 in Makkah, 10 in Madinah)."},{id:"hard_14",category:"Beliefs",question:"What is the name of the bridge over Hell that everyone must cross?",options:["Sirat","Mizan","Araf","Barzakh"],correct:0,explanation:"As-Sirat is the bridge that everyone must cross on the Day of Judgment."},{id:"hard_15",category:"Hadith",question:"What did the Prophet ï·º say is the key to Paradise?",options:["Fasting","Prayer","Charity","Good character"],correct:1,explanation:"The Prophet ï·º said: 'Prayer is the key to Paradise.'"}]},D=f=>{const u=[...f];for(let o=u.length-1;o>0;o--){const A=Math.floor(Math.random()*(o+1));[u[o],u[A]]=[u[A],u[o]]}return u};function ye({onComplete:f,challengeId:u}){const[o,A]=n.useState(null),[m,Q]=n.useState([]),[x,W]=n.useState(0),[Y,q]=n.useState(0),[I,H]=n.useState(0),[S,F]=n.useState(null),[_,B]=n.useState(!1),[K,T]=n.useState(!1),[J,G]=n.useState(!1),[d,L]=n.useState(null),[p,O]=n.useState(null),[y,$]=n.useState(!1),[R,P]=n.useState([]),C=[{id:"easy",name:"Easy",icon:"ðŸŒ±",color:"from-green-500 to-green-600",count:5},{id:"medium",name:"Medium",icon:"âš¡",color:"from-yellow-500 to-orange-500",count:5},{id:"hard",name:"Hard",icon:"ðŸ”¥",color:"from-red-500 to-red-600",count:5}];n.useEffect(()=>{Z(),u&&V()},[u]),n.useEffect(()=>{if(o&&d)X();else if(o&&!d&&!y){const a=k[o],t=D([...a]),s=C.find(i=>i.id===o),h=t.slice(0,s.count);Q(h),P(h.map(i=>i.id))}},[o,d,y]);const Z=async()=>{try{if(await c.auth.isAuthenticated()){const t=await c.auth.me();L(t)}}catch(a){console.log("User not authenticated or error loading user:",a)}},V=async()=>{try{const a=await c.entities.Challenge.filter({id:u});if(a.length>0){const t=a[0];O(t),$(!0),t.difficulty?A(t.difficulty):console.error("Challenge does not specify difficulty.")}}catch(a){console.error("Error loading challenge:",a)}},X=async()=>{if(!d){console.warn("Attempted to load questions avoiding repeats without a user.");return}let a=[];try{const r=await c.entities.UserGameProgress.filter({user_id:d.id,game_type:"islamic_quiz"});r.length>0&&(a=r[0].completed_questions||[])}catch(r){console.log("No previous progress found for user or error fetching progress:",r)}const t=k[o];let s=t.filter(r=>!a.includes(r.id));const i=C.find(r=>r.id===o).count;let l;s.length<i?(console.log(`Not enough new questions for difficulty ${o}. Resetting questions for this round.`),l=t):l=s;const b=D([...l]).slice(0,i);Q(b),P(b.map(r=>r.id))},ee=a=>{F(a),B(!0),a===m[x].correct&&(q(s=>s+2),H(s=>s+1)),setTimeout(()=>{T(!0)},1e3)},ae=()=>{x<m.length-1?(W(a=>a+1),F(null),B(!1),T(!1)):se()},te=async a=>{try{const t=new Date().toISOString().split("T")[0],s=await c.entities.GameScore.filter({user_id:a,created_date:{_gte:`${t}T00:00:00.000Z`,_lte:`${t}T23:59:59.999Z`}});if([...new Set(s.map(l=>l.game_type))].filter(l=>l!=="daily_completion_bonus").length>=13&&!s.find(g=>g.game_type==="daily_completion_bonus")){await c.entities.GameScore.create({user_id:a,game_type:"daily_completion_bonus",score:10,bonus_points:10,completed:!0});const g=await c.auth.me(),b=Math.min((g.points||0)+10,1500);await c.auth.updateMe({points:b}),console.log("Daily completion bonus awarded!")}}catch(t){console.log("Error checking daily bonus:",t)}},se=async()=>{G(!0),setStatusMessage(""),setErrorMessage("");const a=10;if(d)try{await pe(d,"islamic_quiz",{fallbackScore:a}),setStatusMessage("Points awarded successfully! Your profile and leaderboard will update shortly.");const t=await c.entities.UserGameProgress.filter({user_id:d.id,game_type:"islamic_quiz"});if(t.length>0){const s=t[0].completed_questions||[],h=[...new Set([...s,...R])],i=Object.values(k).flat().map(g=>g.id),l=h.length>=i.length?[]:h;await c.entities.UserGameProgress.update(t[0].id,{completed_questions:l,total_games_played:(t[0].total_games_played||0)+1,best_score:Math.max(t[0].best_score||0,a)})}else await c.entities.UserGameProgress.create({user_id:d.id,game_type:"islamic_quiz",completed_questions:R,total_games_played:1,best_score:a});if(y&&p){const s=p.challenger_id===d.id,h=s?{challenger_score:a}:{opponent_score:a},i=s?p.opponent_score:p.challenger_score;if(i!=null){const g=s?a:p.challenger_score,b=s?p.opponent_score:a;let r=null;g>b?r=p.challenger_id:b>g&&(r=p.opponent_id),h.status="completed",r&&(h.winner_id=r)}await c.entities.Challenge.update(p.id,h)}await te(d.id),q(a)}catch(t){setErrorMessage("Failed to award points or save progress. Please check your permissions or try again later."),console.error("Error saving score or user progress:",t)}f&&f(a)};if(!o&&!y)return e.jsxs(v,{className:"max-w-4xl mx-auto shadow-xl",children:[e.jsx(U,{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white p-8",children:e.jsxs(E,{className:"text-3xl text-center flex items-center justify-center gap-3",children:[e.jsx(ie,{className:"w-8 h-8"}),"Choose Your Level"]})}),e.jsx(N,{className:"p-8",children:e.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:C.map((a,t)=>e.jsxs(j.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.1},onClick:()=>A(a.id),className:`p-8 rounded-2xl bg-gradient-to-br ${a.color} text-white shadow-xl hover:shadow-2xl transition-all`,children:[e.jsx("div",{className:"text-6xl mb-4",children:a.icon}),e.jsx("h3",{className:"text-2xl font-bold mb-2",children:a.name}),e.jsxs("p",{className:"text-sm opacity-90",children:[a.count," questions"]})]},a.id))})})]});if(J){const a=Math.round(I/m.length*100);return e.jsx(j.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"text-center py-12",children:e.jsx(v,{className:"max-w-md mx-auto shadow-2xl",children:e.jsxs(N,{className:"pt-12 pb-8",children:[e.jsx(re,{className:"w-24 h-24 mx-auto mb-6 text-amber-500"}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Masha'Allah! ðŸŽ‰"}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6 mb-6",children:[e.jsx("p",{className:"text-5xl font-bold text-blue-600 mb-2",children:"10 points"}),e.jsxs("p",{className:"text-lg text-gray-700",children:["You got ",I," out of ",m.length," correct!"]}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600 mt-2",children:[a,"%"]}),e.jsx("div",{className:"mt-4 p-3 bg-green-100 rounded-lg border-2 border-green-400",children:e.jsxs("p",{className:"text-sm font-bold text-green-900 flex items-center justify-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5 fill-green-500"}),"Fair Points: Every game awards 10 points!"]})}),y&&e.jsx("div",{className:"mt-4 p-4 bg-amber-50 rounded-lg border-2 border-amber-300",children:e.jsx("p",{className:"text-sm font-semibold text-amber-900",children:"âš”ï¸ Challenge score saved! Check the Challenges page to see results."})})]}),e.jsx(M,{onClick:()=>{y?window.location.href=ge("Challenges"):(A(null),W(0),q(0),H(0),G(!1),P([]))},className:"bg-gradient-to-r from-blue-500 to-purple-500",children:y?"View Challenge Results":"Play Again"})]})})})}if(y&&(!o||m.length===0))return e.jsx("div",{className:"text-center py-12",children:"Loading Challenge..."});if(m.length===0)return e.jsx("div",{className:"text-center py-12",children:"Loading..."});const w=m[x],oe=(x+1)/m.length*100;return e.jsxs(v,{className:"max-w-2xl mx-auto shadow-xl",children:[e.jsxs(U,{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(E,{className:"text-2xl",children:"Islamic Quiz"}),e.jsxs("div",{className:"flex items-center gap-2 bg-white/20 px-4 py-2 rounded-full",children:[e.jsx(le,{className:"w-5 h-5"}),e.jsxs("span",{className:"font-bold",children:[Y," pts"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsxs("span",{children:["Question ",x+1," of ",m.length]}),e.jsx(he,{className:"bg-white/20",children:w.category})]}),e.jsx(ce,{value:oe,className:"bg-white/20"})]})]}),e.jsx(N,{className:"p-8",children:K?e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-6",children:S===w.correct?"ðŸŽ‰":"ðŸ“š"}),e.jsx("h3",{className:"text-2xl font-bold text-blue-600 mb-4",children:S===w.correct?"Correct!":"Learn from this:"}),e.jsx("div",{className:"bg-blue-50 rounded-xl p-6 mb-6",children:e.jsx("p",{className:"text-lg text-gray-700",children:w.explanation})}),e.jsx(M,{onClick:ae,size:"lg",className:"bg-gradient-to-r from-blue-500 to-purple-500",children:x<m.length-1?"Next Question":"See Results"})]}):e.jsx(de,{mode:"wait",children:e.jsxs(j.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-8",children:w.question}),e.jsx("div",{className:"grid gap-4",children:w.options.map((a,t)=>{const s=t===w.correct,h=t===S,i=_&&s,l=_&&h&&!s;return e.jsxs(M,{onClick:()=>!_&&ee(t),disabled:_,className:`h-auto py-4 px-6 text-lg justify-start ${i?"bg-green-500 hover:bg-green-600 text-white":l?"bg-red-500 hover:bg-red-600 text-white":"bg-white hover:bg-blue-50 text-gray-900 border-2"}`,variant:_?"default":"outline",children:[e.jsx("span",{className:"flex-1 text-left",children:a}),i&&e.jsx(ue,{className:"w-6 h-6 ml-2"}),l&&e.jsx(me,{className:"w-6 h-6 ml-2"})]},t)})})]},x)})})]})}ye.propTypes={onComplete:z.func,challengeId:z.string};export{ye as default};
